<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core">
    <h:head>
        <title>Analisis Precio Unitario</title>
        <style type="text/css">
            html{
                height: 100%;
            }
            body{
                height: 80%;
            }
        </style>
    </h:head>
    <h:body>
        <ui:composition template="./../menuTemplate.xhtml">
            <ui:define name="content">

                <h:form id="frmRealizarVentas">

                    <p:growl id="mensajeGeneral" showDetail="true"/>          
                    
                    <p:dialog header="Rubros" id="dlg4" widgetVar="dlg4" showEffect="fade" hideEffect="explode" height="145"  modal="true">

                        <p:dataTable value="#{rubroBeanVista.all}" var="item8"  scrollable="true" scrollHeight="100"
                                     style="width:650px ">
                            <p:column headerText="Codigo">
                                <h:outputText value="#{item8.codigoRubro}"/>
                            </p:column>
                            <p:column headerText="NOMBRE" >
                                <h:outputText value="#{item8.nombreRubro}"/>
                            </p:column>
                            <p:column headerText="Detalle">
                                <h:outputText value="#{item8.detalleRubro}"/>
                            </p:column>
                            <p:column headerText="Categoria">
                                <h:outputText value="#{item8.categoriarubro.descripcionCatRubro}"/>
                            </p:column>
                            <p:column headerText="Unidad">
                                <h:outputText value="#{item8.unidadRubro}"/>
                            </p:column>
                            <p:column style="width:8%; text-align: center">
                                <p:commandButton   icon="icon-add" title="Añadir"  actionListener="#{ApuBeanVista.agregarRubroApus(item8.codigoRubro)}"/>
                            </p:column>      

                        </p:dataTable>

                    </p:dialog>           

                    <FIELDSET  style="-moz-border-radius:10px; width: 1118px; "  class="borderFieldSet">
                        <legend>Rubro</legend>

                        <h:panelGrid id="panelFinalVenta4" columns="2" cellpadding="1" >

                            <p:outputLabel value="Codigo:"/>
                            <p:inputText value="#{ApuBeanVista.auxocidigo}" id="auxcodrub" size="10"/>

                            <p:outputLabel value="Descripcion:"/>
                            <p:inputTextarea value="#{ApuBeanVista.auxdesrubro}" id="auxdesru" rows="4" cols="70"/>
                            <p:outputLabel value="Unidad:" />
                            <p:inputText value="#{ApuBeanVista.auxunidrubro}" id="auxunidad" size="20"/>
                            <p:outputLabel value="Categoria:" />
                            <p:inputText value="#{ApuBeanVista.auxcategoria}" id="auxcatru" size="20"/>          
                            <h:panelGroup>
                                <p:commandButton id="btnCrearRubro" oncomplete="dlg4.show()" value="Añadir"/>

                            </h:panelGroup>
                        </h:panelGrid>

                    </FIELDSET>


                    <p:dialog header="Equipos y Herramientas" id="dlg" widgetVar="dlg" showEffect="fade" hideEffect="explode" height="145"  modal="true">

                        <p:dataTable value="#{equipoherramientaBean.listaEquipoHerramienta}" var="item"  scrollable="true" scrollHeight="100"
                                     style="width:650px ">
                            <p:column headerText="Codigo">
                                
                                <h:outputText value="#{item.codigoEqherr}"/>
                            </p:column>
                            <p:column headerText="NOMBRE" >
                                <h:outputText value="#{item.nombreEqherr}"/>
                            </p:column>
                            <p:column headerText="Costo Hora">
                                <h:outputText value="#{item.costohoraEqherr}"/>
                            </p:column>
                            <p:column headerText="Categoria">
                                <h:outputText value="#{item.categoriaequipoherramienta.nombCatEqherr}"/>
                            </p:column>
                            <p:column style="width:8%; text-align: center">
                                <p:commandButton  icon="icon-add" title="Añadir"   actionListener="#{ApuBeanVista.agregarListaEquiposApus(item.codigoEqherr)}"
                                                  />

                            </p:column>
                        </p:dataTable>
                    </p:dialog>


                    <FIELDSET  style="-moz-border-radius:10px;background-color: #dddddd;
                               width: 1118px;" class="borderFieldSet" >
                        <legend>Equipos y Herramientas</legend>
                        <p:dataTable  id="tablaListaProductosVenta" 
                                      editable="true" editMode="cell" value="#{ApuBeanVista.listaEquiposApus}" var="item" scrollable="true" scrollHeight="100">

                          

                            <p:column headerText="NOMBRE" style="text-align: left;">

                                <h:outputText value="#{item.descEqherrApu}"/>

                            </p:column>
                            <p:column headerText="Cantidad" style="text-align: center;">
                              
                                 
                                      <p:inputText value="#{item.cantEqherrApu}" style="text-align: center;" />                     
                               
                            </p:column>
                            <p:column headerText="Tarifa" style="text-align: center;">
                                $./     <h:outputText value="#{item.tarifaEqherrApu}" />
                            </p:column>

                            <p:column headerText="Costo Hora" style="text-align: center;">
                                $./   <h:outputText value="#{item.costohoraEqherrApu}" />
                            </p:column>
                            <p:column headerText="Rendimiento" style="text-align: center;">
                               
                                    
                                     <p:inputText value="#{item.rendimEqherrApu}" style="text-align: center;" />  </p:column>               
                            <p:column headerText="Total" style="text-align: center;">
                                $./ 
                                <h:outputText value="#{item.costotEqherrApu}"/>
                            </p:column>
                            <p:column style="text-align: center;">
                                <p:commandButton value="Retirar de la lista" ajax="true" actionListener="#{ApuBeanVista.EliminarListaEquipo(item.descEqherrApu)}"/>
                            </p:column >

                        </p:dataTable >

                        <p:panelGrid id="panelFinalVenta" columns="1" style="text-align: right;width: 98%;">
                            <h:panelGroup>
                                <p:commandButton id="btnProyectoCreate"  oncomplete="dlg.show()"  value="Añadir"/>  
                                Total $./
                                <h:outputText value="#{ApuBeanVista.precioTotalEquipo}" style="box-shadow: 0px 0px 2px rgba(0, 0, 0, 0.7);padding: 7px;"/>               
                                ____________
                                <p:commandButton value="Calcular" actionListener="#{ApuBeanVista.calcularCostos()}" />
                               
                            </h:panelGroup>
                        </p:panelGrid>
                    </FIELDSET>     




                    <p:dialog header="Effects" id="dlg1" widgetVar="dlg1" showEffect="fade" hideEffect="explode" height="145"  modal="true">

                        <p:dataTable value="#{manodeobraBean.listamanoobra}" var="item2"  scrollable="true" scrollHeight="100"
                                     style="width:650px ">
                            <p:column headerText="Codigo">
                                <h:outputText value="#{item2.codigoManob}"/>
                            </p:column>
                            <p:column headerText="NOMBRE" >
                                <h:outputText value="#{item2.nombreManob}"/>
                            </p:column>
                            <p:column headerText="Costo Jornal H/R">
                                <h:outputText value="#{item2.costojrhManob}"/>
                            </p:column>
                            <p:column headerText="Categoria">
                                <h:outputText value="#{item2.categoriamanoobra.nombCatManob}"/>
                            </p:column>
                            <p:column>
                                <p:commandButton value="Seleccionar"  actionListener="#{ApuBeanVista.agregarListaManobraApu(item2.codigoManob)}"
                                                 />

                            </p:column>

                        </p:dataTable>
                    </p:dialog>

                    <FIELDSET  style="-moz-border-radius:10px;background-color: #dddddd;
                               width: 1118px;" class="borderFieldSet" >
                        <legend>Mano de Obra</legend>
                        <p:dataTable id="tablaListaProductosVenta1" value="#{ApuBeanVista.listaManoBra}" var="item1" scrollable="true" scrollHeight="100">


                            <p:column headerText="NOMBRE" style="text-align: left;">
                                <h:outputText value="#{item1.descMoApu}"/>
                            </p:column>
                            <p:column headerText="Cantidad" style="text-align: center;">
                                <p:inputText value="#{item1.cantMoApu}" style="text-align: center;" />                    
                            </p:column>

                            <p:column headerText="Costo Jornal H/R" style="text-align: center;">
                                S./   <h:outputText value="#{item1.costojrhMoApu}"  />
                            </p:column>

                            <p:column headerText="Costo Hora" style="text-align: center;">
                                S./   <h:outputText value="#{item1.costohoraMoApu}" />
                            </p:column>      

                            <p:column headerText="Rendimiento" style="text-align: center;">
                                <p:inputText value="#{item1.rendimMoApu}" style="text-align: center;" />                    
                            </p:column>

                            <p:column headerText="Total" style="text-align: center;">
                                S./ 
                                <h:outputText value="#{item1.costotMoApu}"/>
                            </p:column>
                            <p:column style="text-align: center;">
                                <p:commandButton value="Retirar de la lista" ajax="true" actionListener="#{ApuBeanVista.EliminarListaManObra(item1.descMoApu)}"/>
                            </p:column>

                        </p:dataTable>
                        <p:panelGrid id="panelFinalVenta1" columns="1" style="text-align: right;width: 100%;">
                            <h:panelGroup>
                                <p:commandButton id="btnProyectoCreate1"  oncomplete="dlg1.show()"  value="Añadir">  
                                </p:commandButton>   

                                <p:commandButton value="Calcular" actionListener="#{ApuBeanVista.calcularCostosManobra()}" />
                                Total $./ 
                                <h:outputText value="#{ApuBeanVista.precioTotalmanoobra}" style="box-shadow: 0px 0px 2px rgba(0, 0, 0, 0.7);padding: 7px;"/>
                                _________          
                            </h:panelGroup>
                        </p:panelGrid>
                    </FIELDSET>     
                    <!--  </h:form> -->

                    <!--<h:form id="frmRealizarVentas2">-->
                    <!--<p:growl id="mensajeGeneral2" showDetail="true"/>-->   

                    <p:dialog header="Effects" id="dlg2" widgetVar="dlg2" showEffect="fade" hideEffect="explode" height="145"  modal="true">

                        <p:dataTable value="#{materialBean.listaMateriales}" var="item4"  scrollable="true" scrollHeight="100"
                                     style="width:650px ">
                            <p:column headerText="Codigo">
                                <h:outputText value="#{item4.codigoMat}"/>
                            </p:column>
                            <p:column headerText="Nombre" >
                                <h:outputText value="#{item4.nombreMat}"/>
                            </p:column>
                            <p:column headerText="Unidad" >
                                <h:outputText value="#{item4.unidMat}"/>
                            </p:column>
                            <p:column headerText="Costo Unitario">
                                <h:outputText value="#{item4.precunitMat}"/>
                            </p:column>
                            <p:column headerText="Categoria">
                                <h:outputText value="#{item4.categoriamaterial.nombCatMat}"/>
                            </p:column>
                            <p:column>
                                <p:commandButton value="Seleccionar"  actionListener="#{ApuBeanVista.agregarListaMaterialApu(item4.codigoMat)}"
                                                 />

                            </p:column>
                        </p:dataTable>
                    </p:dialog>

                    <FIELDSET  style="-moz-border-radius:10px;background-color: #dddddd;
                               width: 1118px;" class="borderFieldSet" >
                        <legend>Materiales</legend>
                        <p:dataTable id="tablaListaProductosVenta2" value="#{ApuBeanVista.listaMaterialApus}" var="item3" scrollable="true" scrollHeight="100">


                            <p:column headerText="NOMBRE" style="text-align: left;">
                                <h:outputText value="#{item3.descMatApu}"/>
                            </p:column>
                            <p:column headerText="Unidad" style="text-align: center;">
                                <h:outputText value="#{item3.unidMatApu}"/>
                            </p:column>
                            <p:column headerText="Cantidad" style="text-align: center;">
                                <p:inputText value="#{item3.cantMatApu}" style="text-align: center;" />                    
                            </p:column>
                            <p:column headerText="Costo Unitario" style="text-align: center;">
                                <h:outputText value="#{item3.preunitMatApu}"/>                 
                            </p:column>
                            <p:column headerText="Total" style="text-align: center;">
                                S./ 
                                <h:outputText value="#{item3.costotMatApu}"/>
                            </p:column>
                            <p:column style="text-align: center;">
                                <p:commandButton value="Retirar de la lista" ajax="true" actionListener="#{ApuBeanVista.EliminarListaMateriales(item3.descMatApu)}"/>
                            </p:column>
                        </p:dataTable>
                        <p:panelGrid id="panelFinalVenta2" columns="1" style="text-align: right;width: 100%;">
                            <h:panelGroup>
                                <p:commandButton id="btnProyectoCreate2"  oncomplete="dlg2.show()"  value="Añadir">  
                                </p:commandButton>   

                                <p:commandButton value="Calcular" actionListener="#{ApuBeanVista.calcularCostosMateriales()}" />
                                Total $./ 
                                <h:outputText value="#{ApuBeanVista.precioTotalmaterial}" style="box-shadow: 0px 0px 2px rgba(0, 0, 0, 0.7);padding: 7px;"/>
                                _______

                            </h:panelGroup>
                        </p:panelGrid>
                    </FIELDSET>     
                    <!--  </h:form>     -->


                    <!--aumento de dialogo para crear equipos y herramientas-->
                    <!--aumento materiales para crear equipos y herramientas-->
                    <!-- <h:form id="frmRealizarVentas3">-->
                    <!--  <p:growl id="mensajeGeneral3" showDetail="true"/>  --> 

                    <p:dialog header="Effects" id="dlg3" widgetVar="dlg3"
                              showEffect="fade" hideEffect="explode" height="145"  modal="true">

                        <p:dataTable value="#{transportesBean.listaTransporte}" var="item5"  scrollable="true" scrollHeight="100"
                                     style="width:650px ">
                            <p:column headerText="Codigo">
                                <h:outputText value="#{item5.codigoTransp}"/>
                            </p:column>
                            <p:column headerText="NOMBRE" >
                                <h:outputText value="#{item5.nombreTransp}"/>
                            </p:column>
                            <p:column headerText="Tarifa">
                                <h:outputText value="#{item5.tarifaTransp}"/>
                            </p:column>
                            <p:column headerText="Categoria">
                                <h:outputText value="#{item5.categoriatransporte.nombCatTrans}"/>
                            </p:column>
                            <p:column>
                                <p:commandButton value="Seleccionar"  actionListener="#{ApuBeanVista.agregarListaTransporteApu(item5.codigoTransp)}"
                                                 />

                            </p:column>
                        </p:dataTable>
                    </p:dialog>

                    <FIELDSET  style="-moz-border-radius:10px;background-color: #dddddd;
                               width: 1118px;" class="borderFieldSet" >
                        <legend>Transporte</legend>
                        <p:dataTable id="tablaListaProductosVenta3" value="#{ApuBeanVista.listaTransporteApus}" var="item6" scrollable="true" scrollHeight="100">


                            <p:column headerText="NOMBRE" style="text-align: left;">
                                <h:outputText value="#{item6.descTranApu}"/>
                            </p:column>

                            <p:column headerText="Unidad" style="text-align: center;">
                                <h:outputText value="#{item6.unidTranApu}" style="text-align: center;" />                    
                            </p:column>
                            <p:column headerText="Cantidad" style="text-align: center;">
                                <p:inputText value="#{item6.cantTranApu}" style="text-align: center;" />                    
                            </p:column>

                            <p:column headerText="Tarifa" style="text-align: center;">
                                S./   <h:outputText value="#{item6.tarifaTranApu}"/>                  
                            </p:column>
                            <p:column headerText="Total" style="text-align: center;">
                                S./ 
                                <h:outputText value="#{item6.costotTranApu}"/>
                            </p:column>
                            <p:column style="text-align: center;">
                                <p:commandButton value="Retirar de la lista" ajax="true" actionListener="#{ApuBeanVista.EliminarListaTransporte(item6.descTranApu)}"/>
                            </p:column>
                        </p:dataTable>
                        <p:panelGrid id="panelFinalVenta3" columns="1" style="text-align: right;width: 100%;">
                            <h:panelGroup>
                                <p:commandButton id="btnProyectoCreate3"  oncomplete="dlg3.show()"  value="Añadir">  
                                </p:commandButton>   

                                <p:commandButton value="Calcular" actionListener="#{ApuBeanVista.calcularCostosTransporte()}" />
                                Total $./ 
                                <h:outputText value="#{ApuBeanVista.precioTotaltransporte}" style="box-shadow: 0px 0px 2px rgba(0, 0, 0, 0.7);padding: 7px;"/>          
                                ________

                            </h:panelGroup>
                        </p:panelGrid>
                    </FIELDSET>     


                    <FIELDSET  style="-moz-border-radius:10px; width: 1118px; "  class="borderFieldSet">
                        <legend>Costo Rubro</legend>

                        <h:panelGrid id="panelFinalVenta5" columns="5" cellpadding="8" style="float:right" border="2">

                            <p:ajax event="keyup" update="otrocostodirecto" listener="#{ApuBeanVista.calcularCostosTotalesAPU()}" /> 
                            <p:outputLabel value="Costo Directo (EH+M+MO+T)$:"  for="costodirecto" />
                            <h:outputText  value="#{ApuBeanVista.totaldirAPU}" id="costodirecto" style="box-shadow: 0px 0px 2px rgba(0, 0, 0, 0.7);padding: 7px;" />


                            <p:outputLabel value="Costo Indirecto y Utilidades$:" for="costoindirecto" />
                            <p:inputText value="#{ApuBeanVista.auxiliarPorcenjate}" id="costoindirectoaux" size="10"/>
                            <h:outputText value="#{ApuBeanVista.costoinAPu}" id="costoindirecto" style="box-shadow: 0px 0px 2px rgba(0, 0, 0, 0.7);padding: 7px;"/>
                            <p:outputLabel value="Otros Costos Indirectos:" for="otrocostodirecto" />
                            <p:inputText value="#{ApuBeanVista.auxiliarotroscostos}" id="otrocostodirecto" size="10"/>  
                            <p:outputLabel value="Valor Ofertado:" for="valorofertado" />
                            <h:outputText value="#{ApuBeanVista.costoaputotal}" id="valorofertado" style="box-shadow: 0px 0px 2px rgba(0, 0, 0, 0.7);padding: 7px;"/>

                            <h:panelGroup>

                                <p:commandButton value="Guardar" ajax="false" actionListener="#{ApuBeanVista.guardarAPU()}"/>
                                <p:commandButton value="IMPRIMIR PDF" ajax="false" actionListener="#{ApuBeanVista.imprimirpdfaapu()}"/>
                                  
                                <p:commandButton value="IMPRIMIR EXCEL" ajax="false" actionListener="#{ApuBeanVista.imprimirexcelapu()}"/>

 
                            </h:panelGroup>
                        </h:panelGrid>


                    </FIELDSET>


                </h:form> 



            </ui:define>
        </ui:composition>
    </h:body>
</html>

